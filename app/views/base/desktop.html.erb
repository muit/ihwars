<section class="bck grey margin-top margin-bottom">
    <div class="row text center">
        <nav id="base_list" data-tuktuk="menu" class="column_12 padding text bold">
            <% if @bases.length <= 0 %>
                <a id='create_base' class='baseName active' ><span class='icon plus-sign'></span>Crea una base!</a>
            <% else %>
                <% @bases.each_with_index do |base, index| %>
                    <a id='<%= index %>' class='baseName <%= "active" if index == 0 %>'><span class='icon building'></span><%= base.name %><small>(1)</small></a>
                <% end %>
                <% if @bases.length < Settings.maxBases %>
                  <a id='create_base' class='baseName'><span class='icon plus-sign'></span>Nueva Base</a>
                <% end %>
            <% end %>
        </nav>
    </div>
</section>


<section id="mainSection" class="padding-left padding-right">
    <div class="baseDataBox row ">
      <% if @bases.length > 0 %>
      <div class="dataColumn column_6 padding-top padding-bottom">
          <h4 class="baseDataTitle text italic bold color theme margin-left">Edificios:</h4>
          <% Cache.buildings.each do |building| %>
            <div id="<%= building[:type_id] %>" class="buildingList baseData column_5 bck grey margin-bottom padding">
              <%= building[:name] %>
              <div class="on-right">
                <% units = @bases.first.building_units.where(:type_id => building[:type_id]) %>
                <% if units != nil %>
                  <%= units.length %>
                <% else %>
                  0
                <% end %>
              </div>
            </div>
          <% end %>
      </div>
      <div class="dataColumn column_6 padding-top padding-bottom">
          <h4 class="baseDataTitle text italic bold color theme margin-left">Unidades:</h4>
          <% Cache.entities.each do |entity| %>
            <div id="<%= entity[:type_id] %>" class="entityList baseData column_5 bck grey margin-bottom padding">
              <%= entity[:name] %>
              <div class="on-right">
                <a class="entityAdd icon plus-sign"></a>
                <a class="entityAdd icon minus-sign"></a>
                <% stack = @bases.first.entity_stacks.where(:type_id => entity[:type_id])[0] %>
                <% if stack != nil %>
                  <%= stack.amount  %>
                <% else %>
                  0
                <% end %>
              </div>
            </div>
          <% end %>
      </div>
      <% end %>
      <div class="dataPanel hidden column_10 bck grey margin padding">
        <h4 class="dataPanelTitle text italic bold color theme margin-left">Title:</h4>
      </div>
    </div>
</section>

<div id="alert" data-tuktuk="modal" data-modal="alert" class="column_5">
  <header class="bck alert">
    <h4 class="text thin inline">Alert</h4>
  </header>
  <article id="alert_text" class="text big"></article>
  <footer>
    <button id="alert_close" class="button large success on-right margin-bottom">
      <span class="icon ok"></span>
    </button>
  </footer>
</div>
<div id="formModal" data-tuktuk="modal" data-modal="prompt" class="column_5">
  <header class="bck notice color white">
    <h4 class="text inline">Nombre de la base?</h4>
  </header>
  <article class="text big">
    <form>
      <label id="text"></label>
      <input type="text" id="formModal_text">
    </form>
  </article>
  <footer>
    <button id="formModal_buttonNOT" class="button alert on-right margin-bottom">
      <span class="icon remove"></span>
    </button>
    <button id="formModal_buttonOK" class="button theme on-right margin-bottom margin-right">
      <span class="icon ok"></span>
    </button>
  </footer>
</div>
<div data-tuktuk="modal" data-modal="confirm" class="column_5">
  <header class="bck alert">
    <h4 class="text thin inline">Confirm</h4>
  </header>
  <article id="text" class="text big"></article>
  <footer>
    <button class="button large alert on-right margin-bottom">
      <span class="icon remove"></span>
    </button>
    <button class="button large success on-right margin-bottom margin-right">
      <span class="icon ok"></span>
    </button>
  </footer>
</div>

<div data-tuktuk="lock" data-loading="false">
  <div class="loading"></div>
</div>

<script>
  Base.size = <%= @bases.length%>
  Base.building_types = [
  <% Cache.buildings.each do |building| %>
    {type_id: <%=building[:type_id]%>, name: "<%=building[:name]%>"},
  <% end %>
  ]
  Base.entity_types = [
  <% Cache.entities.each do |entity| %>
    {type_id: <%=entity[:type_id]%>, name: "<%=entity[:name]%>"},
  <% end %>
  ]
</script>